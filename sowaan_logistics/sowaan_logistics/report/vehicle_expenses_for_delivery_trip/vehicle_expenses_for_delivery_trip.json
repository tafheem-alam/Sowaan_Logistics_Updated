{
 "add_total_row": 1,
 "add_translate_data": 0,
 "columns": [],
 "creation": "2024-10-01 09:45:42.815958",
 "disabled": 0,
 "docstatus": 0,
 "doctype": "Report",
 "filters": [
  
 ],
 "idx": 8,
 "is_standard": "Yes",
 "letter_head": "Sasco",
 "letterhead": null,
 "modified": "2025-12-02 19:54:59.243006",
 "modified_by": "Administrator",
 "module": "Sowaan Logistics",
 "name": "Vehicle Expenses for Delivery Trip",
 "owner": "ghaith.albarmawi@sowaan.com",
 "prepared_report": 0,
 "ref_doctype": "Delivery Trip",
 "report_name": "Vehicle Expenses for Delivery Trip",
 "report_script": "# Filter values from the report parameters\r\nvalues = {\r\n    \"from\": filters.get(\"from\"),\r\n    \"to\": filters.get(\"to\"),\r\n    \"company\": filters.get(\"company\"),\r\n    \"vehicle\": filters.get(\"vehicle\"),\r\n     \"driver\": filters.get(\"driver\")\r\n}\r\n\r\n# SQL Query to fetch data with decimal formatting\r\nresults = frappe.db.sql(\"\"\" \r\nSELECT \r\n    dt.vehicle AS 'Vehicle',\r\n    dt.driver AS 'Driver',\r\n    DATE(dt.departure_time) AS 'Trip Date',\r\n    FORMAT(ds.distance, 2) AS 'Distance Covered',\r\n    FORMAT(ds.custom_total_value, 2) AS 'Fuel Consumption Qty'\r\nFROM \r\n    `tabDelivery Stop` ds\r\nINNER JOIN \r\n    `tabDelivery Trip` dt ON dt.name = ds.parent\r\nWHERE \r\n    ds.docstatus = 1\r\n    AND (Date(dt.departure_time) BETWEEN %(from)s AND %(to)s OR %(from)s IS NULL OR %(to)s IS NULL)\r\n    AND (dt.company = %(company)s OR %(company)s IS NULL)\r\n    AND (dt.vehicle = %(vehicle)s OR %(vehicle)s IS NULL)\r\n    AND (dt.driver = %(driver)s OR %(driver)s IS NULL)\r\n\"\"\", values, as_dict=True)\r\n\r\n# Define columns for the report\r\ncolumns = [\r\n    {\"fieldname\": \"Vehicle\", \"label\": \"Vehicle\", \"fieldtype\": \"Link\", \"options\": \"Vehicle\"},\r\n    {\"fieldname\": \"Driver\", \"label\": \"Driver\", \"fieldtype\": \"Link\", \"options\": \"Driver\"},\r\n    {\"fieldname\": \"Trip Date\", \"label\": \"Trip Date\", \"fieldtype\": \"Date\"},  # Assuming you want just the date\r\n    {\"fieldname\": \"Distance Covered\", \"label\": \"Distance Covered\", \"fieldtype\": \"Float\"},\r\n    {\"fieldname\": \"Fuel Consumption Qty\", \"label\": \"Fuel Consumption Qty\", \"fieldtype\": \"Float\"},\r\n]\r\n# Return the data\r\ndata = columns, results\r\n",
 "report_type": "Script Report",
 "roles": [
  {
   "role": "Delivery Manager"
  },
  {
   "role": "Fulfillment User"
  },
  {
   "role": "Delivery User"
  },
  {
   "role": "Employee Self Service"
  },
  {
   "role": "Stock Manager"
  },
  {
   "role": "Logistic User"
  }
 ],
 "timeout": 0
}